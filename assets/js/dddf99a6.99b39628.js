"use strict";(self.webpackChunknotesaurus=self.webpackChunknotesaurus||[]).push([[2594],{3241:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var i=t(5893),r=t(1151);const s={sidebar_position:2},a="Suppress SSL",o={id:"react-native/Miscellaneous/suppress-ssl",title:"Suppress SSL",description:"This feature is applied to testing environment which makes use of self signed certificate and lead to security error (Android or iOS will check the validity of SSL certificate). Remember to remove this feature from production version.",source:"@site/docs/react-native/Miscellaneous/suppress-ssl.md",sourceDirName:"react-native/Miscellaneous",slug:"/react-native/Miscellaneous/suppress-ssl",permalink:"/Notesaurus/docs/react-native/Miscellaneous/suppress-ssl",draft:!1,unlisted:!1,editUrl:"https://github.com/athomasliz/Notesaurus/tree/main/docs/react-native/Miscellaneous/suppress-ssl.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Native Bridging",permalink:"/Notesaurus/docs/react-native/Miscellaneous/native-bridging"},next:{title:"iOS Distribution",permalink:"/Notesaurus/docs/react-native/Miscellaneous/ios-distribution"}},c={},l=[{value:"iOS",id:"ios",level:2},{value:"Android",id:"android",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"suppress-ssl",children:"Suppress SSL"}),"\n",(0,i.jsx)(n.p,{children:"This feature is applied to testing environment which makes use of self signed certificate and lead to security error (Android or iOS will check the validity of SSL certificate). Remember to remove this feature from production version."}),"\n",(0,i.jsx)(n.h2,{id:"ios",children:"iOS"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the package ",(0,i.jsx)(n.strong,{children:"React-RCTNetwork"}),", add the following code:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objc",metastring:'title="RCTHTTPRequestHandler.mm"',children:"(void)URLSession:(NSURLSession *)session didReceiveChallenge:(NSURLAuthenticationChallenge *)challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential *credential))completionHandler\n{\n    completionHandler(NSURLSessionAuthChallengeUseCredential, [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]);\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"android",children:"Android"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Create a new custom HTTP Client Factory Class ",(0,i.jsx)(n.strong,{children:"CustomClientFactory.java"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="android/app/src/main/java/com/xxx/CustomClientFactory.java"',children:'public class CustomClientFactory implements OkHttpClientFactory {\n    private static final String TAG = "OkHttpClientFactory";\n    @Override\n    public OkHttpClient createNewNetworkModuleClient() {\n        try {\n            // Create a trust manager that does not validate certificate chains\n            final TrustManager[] trustAllCerts = new TrustManager[]{\n                new X509TrustManager() {\n                    @Override\n                    public void checkClientTrusted(java.security.cert.X509Certificate[] chain, String authType) throws CertificateException {\n                    }\n\n                    @Override\n                    public void checkServerTrusted(java.security.cert.X509Certificate[] chain, String authType) throws CertificateException {\n                    }\n\n                    @Override\n                    public java.security.cert.X509Certificate[] getAcceptedIssuers() {\n                        return new java.security.cert.X509Certificate[]{};\n                    }\n                }\n            };\n\n            // Install the all-trusting trust manager\n            final SSLContext sslContext = SSLContext.getInstance("SSL");\n            sslContext.init(null, trustAllCerts, new java.security.SecureRandom());\n\n            // Create an ssl socket factory with our all-trusting manager\n            final SSLSocketFactory sslSocketFactory = sslContext.getSocketFactory();\n\n            OkHttpClient.Builder builder = new OkHttpClient.Builder()\n                    .connectTimeout(0, TimeUnit.MILLISECONDS).readTimeout(0, TimeUnit.MILLISECONDS)\n                    .writeTimeout(0, TimeUnit.MILLISECONDS).cookieJar(new ReactCookieJarContainer());\n            builder.sslSocketFactory(sslSocketFactory, (X509TrustManager) trustAllCerts[0]);\n            builder.hostnameVerifier(new HostnameVerifier() {\n                @Override\n                public boolean verify(String hostname, SSLSession session) {\n                    return true;\n                }\n            });\n\n            OkHttpClient okHttpClient = builder.build();\n            return okHttpClient;\n        } catch (Exception e) {\n            Log.e(TAG, e.getMessage());\n            throw new RuntimeException(e);\n        }\n    }\n\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.strong,{children:"onCreate"})," method in ",(0,i.jsx)(n.strong,{children:"MainApplicaton.java"}),", add the following line."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="android/app/src/main/java/com/emoapp/MainApplication.java"',children:"public void onCreate() {\n    ...\n    OkHttpClientProvider.setOkHttpClientFactory(new CustomClientFactory());\n    ...\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.strong,{children:"AndroidManifest.xml"}),", add the network security configuration ",(0,i.jsx)(n.strong,{children:"network_security_config.xml"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",metastring:'title="android/app/src/main/AndroidManifest.xml"',children:'<application\n  ...\n  android:networkSecurityConfig="@xml/network_security_config"\n  ...\n>\n</application>\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.strong,{children:"network_security_config.xml"}),", add omain config, which include the domain and the self signed SSL certificate."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",metastring:'title="android/app/src/main/res/xml/network_security_config.xml"',children:'<?xml version="1.0" encoding="utf-8"?>\n<network-security-config>\n    ...\n    <domain-config>\n        <domain includeSubdomains="true">www.xxx.com</domain>\n        <trust-anchors>\n        <certificates src="@raw/direct"/>\n        </trust-anchors>\n    </domain-config>\n</network-security-config>\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Add the self-signed certificate(without the file extention) under the ",(0,i.jsx)(n.strong,{children:"android/app/src/main/res/raw"})," folder."]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>a});var i=t(7294);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);